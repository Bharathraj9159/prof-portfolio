<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Galactic Explorer Maze</title>
  <style>
    body {
      margin: 0;
      background: radial-gradient(circle, #000, #111, #222);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      color: #fff;
      font-family: 'Courier New', Courier, monospace;
    }
    #gameCanvas {
      background: #000;
      border: 2px solid #fff;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
    }
    #overlay {
      margin-top: 20px;
      text-align: center;
    }
    button {
      padding: 10px 20px;
      background: #ff6600;
      border: none;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="400" height="400"></canvas>
  <div id="overlay">
    <div id="status">Engine: Not Collected | Fuel: Not Collected | Navigation: Not Collected</div>
    <div id="message">Collect all spaceship parts and reach the wormhole!</div>
    <button id="restartBtn">Restart Mission</button>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const canvas = document.getElementById('gameCanvas');
      const ctx = canvas.getContext('2d');
      const cellSize = 40;
      const offset = 5;
      const animationDuration = 200;
      let moving = false;
      let animationStartTime = 0;
      let startX, startY, targetX, targetY;
      
      // Maze grid: 1 = wall, 0 = open path, string = spaceship part.
      const originalMaze = [
        [1,1,1,1,1,1,1,1,1,1],
        [1,0,0,0,1,0,0,0,0,1],
        [1,0,1,0,1,0,1,1,0,1],
        [1,0,"Fuel",0,0,0,1,0,0,1],
        [1,0,1,1,1,1,1,"Navigation",1,1],
        [1,0,0,0,0,0,0,0,0,1],
        [1,1,1,1,1,1,0,1,1,1],
        [1,0,0,0,0,1,0,"Engine",0,1],
        [1,0,1,1,0,1,1,1,0,1],
        [1,1,1,1,1,1,1,1,1,1]
      ];
      let maze = JSON.parse(JSON.stringify(originalMaze));
      
      // Player object with cell coordinates and pixel positions.
      let player = { 
        x: 1, 
        y: 1, 
        pixelX: 1 * cellSize + offset, 
        pixelY: 1 * cellSize + offset, 
        collected: [] 
      };
      const goal = { x: 8, y: 8 };
      const requiredParts = ["Engine", "Fuel", "Navigation"];
      
      let targetCellX, targetCellY;
      
      // Draw the maze, spaceship parts, wormhole and player.
      function drawMaze() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let y = 0; y < maze.length; y++) {
          for (let x = 0; x < maze[y].length; x++) {
            if (maze[y][x] === 1) {
              ctx.fillStyle = '#444';
              ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
            } else if (typeof maze[y][x] === 'string') {
              ctx.fillStyle = '#ff6600';
              ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
              ctx.fillStyle = '#fff';
              ctx.font = 'bold 12px Courier';
              ctx.fillText(maze[y][x], x * cellSize + 4, y * cellSize + 24);
            } else {
              ctx.fillStyle = '#000';
              ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
            }
          }
        }
        // Draw the wormhole portal (goal)
        ctx.fillStyle = '#00ff00';
        ctx.beginPath();
        ctx.arc(goal.x * cellSize + cellSize / 2, goal.y * cellSize + cellSize / 2, cellSize / 3, 0, Math.PI * 2);
        ctx.fill();
        
        // Draw the player (astronaut)
        ctx.fillStyle = '#00aaff';
        ctx.fillRect(player.pixelX, player.pixelY, cellSize - 10, cellSize - 10);
      }
      
      // Update the status overlay.
      function updateStatus() {
        const statusDiv = document.getElementById('status');
        statusDiv.textContent = `Engine: ${player.collected.includes('Engine') ? 'Collected' : 'Not Collected'} | Fuel: ${player.collected.includes('Fuel') ? 'Collected' : 'Not Collected'} | Navigation: ${player.collected.includes('Navigation') ? 'Collected' : 'Not Collected'}`;
      }
      
      // Smoothly animate the player's movement between grid cells.
      function animate(timestamp) {
        if (!animationStartTime) animationStartTime = timestamp;
        const elapsed = timestamp - animationStartTime;
        const progress = Math.min(elapsed / animationDuration, 1);
        player.pixelX = startX + (targetX - startX) * progress;
        player.pixelY = startY + (targetY - startY) * progress;
        drawMaze();
        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          player.x = targetCellX;
          player.y = targetCellY;
          player.pixelX = player.x * cellSize + offset;
          player.pixelY = player.y * cellSize + offset;
          moving = false;
          animationStartTime = 0;
          // Collect spaceship part if available.
          if (typeof maze[player.y][player.x] === 'string') {
            if (!player.collected.includes(maze[player.y][player.x])) {
              player.collected.push(maze[player.y][player.x]);
              updateStatus();
            }
            maze[player.y][player.x] = 0;
          }
          checkWinCondition();
        }
      }
      
      // Initiate player movement if not currently moving.
      function movePlayer(dx, dy) {
        if (moving) return;
        const newX = player.x + dx;
        const newY = player.y + dy;
        // Boundary and wall check.
        if (newX < 0 || newX >= maze[0].length || newY < 0 || newY >= maze.length) return;
        if (maze[newY][newX] !== 1) {
          moving = true;
          targetCellX = newX;
          targetCellY = newY;
          startX = player.x * cellSize + offset;
          startY = player.y * cellSize + offset;
          targetX = newX * cellSize + offset;
          targetY = newY * cellSize + offset;
          requestAnimationFrame(animate);
        }
      }
      
      // Check if the mission is complete.
      function checkWinCondition() {
        const messageDiv = document.getElementById('message');
        if (player.x === goal.x && player.y === goal.y) {
          if (requiredParts.every(part => player.collected.includes(part))) {
            messageDiv.textContent = "Mission Success! You've repaired your spaceship and found the wormhole!";
          } else {
            messageDiv.textContent = "Mission Failed! Collect all parts before entering the wormhole!";
            setTimeout(resetPlayer, 1000);
          }
        } else {
          messageDiv.textContent = "Collect all spaceship parts and reach the wormhole!";
        }
      }
      
      // Reset the player's position if mission conditions are not met.
      function resetPlayer() {
        player.x = 1;
        player.y = 1;
        player.pixelX = player.x * cellSize + offset;
        player.pixelY = player.y * cellSize + offset;
        drawMaze();
      }
      
      // Restart the mission.
      function restartGame() {
        maze = JSON.parse(JSON.stringify(originalMaze));
        player = { 
          x: 1, 
          y: 1, 
          pixelX: 1 * cellSize + offset, 
          pixelY: 1 * cellSize + offset, 
          collected: [] 
        };
        updateStatus();
        drawMaze();
        document.getElementById('message').textContent = "Collect all spaceship parts and reach the wormhole!";
      }
      
      // Listen for arrow key input for movement.
      document.addEventListener('keydown', (event) => {
        if (moving) return;
        switch (event.key) {
          case 'ArrowUp': movePlayer(0, -1); break;
          case 'ArrowDown': movePlayer(0, 1); break;
          case 'ArrowLeft': movePlayer(-1, 0); break;
          case 'ArrowRight': movePlayer(1, 0); break;
        }
      });
      
      document.getElementById('restartBtn').addEventListener('click', restartGame);
      drawMaze();
      updateStatus();
    });
  </script>
</body>
</html>
